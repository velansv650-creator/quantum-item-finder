<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quantum Item Finder</title>

<!-- PREMIUM UI -->
<style>
  body{
    margin:0;
    font-family: "Segoe UI", Roboto, sans-serif;
    background: linear-gradient(135deg,#1f4037,#99f2c8);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
  }
  .card{
    background:#fff;
    width:92%;
    max-width:420px;
    border-radius:20px;
    padding:22px;
    box-shadow:0 20px 40px rgba(0,0,0,.25);
  }
  h2{text-align:center;margin:10px 0 20px}
  input,select,button{
    width:100%;
    padding:14px;
    margin-top:10px;
    border-radius:12px;
    border:1px solid #ddd;
    font-size:16px;
  }
  button{
    border:none;
    cursor:pointer;
    font-weight:600;
  }
  .primary{background:#3b6fdc;color:#fff}
  .danger{background:#d9534f;color:#fff}
  .success{background:#3c8d40;color:#fff}
  .outline{background:#fff;border:1px solid #ccc}
  .hidden{display:none}
  .shopBox{
    margin-top:20px;
    padding-top:15px;
    border-top:1px solid #eee;
  }
  iframe{border-radius:12px;margin-top:10px}
  .qr{text-align:center;margin-top:15px}
</style>
</head>

<body>

<div class="card">

<!-- üîê LOGIN -->
<div id="loginBox">
  <h2>üîê Login / Signup</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button class="primary" onclick="login()">Login / Signup</button>
</div>

<!-- üîç SEARCH -->
<div id="searchBox" class="hidden">
  <h2>üîç Item Search</h2>

  <select id="category">
    <option>Grocery</option>
    <option>Vegetables</option>
    <option>Fruits</option>
    <option>Medical</option>
    <option>Stationery</option>
    <option>Electronics</option>
    <option>Bakery</option>
    <option>Dairy</option>
  </select>

  <input id="item" placeholder="Item name (Rice / Tablet / Pen)">

  <select id="area">
    <option>Velachery</option>
    <option>T Nagar</option>
    <option>Adyar</option>
    <option>Anna Nagar</option>
    <option>Guindy</option>
    <option>Tambaram</option>
    <option>Medavakkam</option>
    <option>Sholinganallur</option>
    <option>OMR</option>
    <option>ECR</option>
    <option>Chromepet</option>
    <option>Pallavaram</option>
    <option>Ambattur</option>
    <option>Avadi</option>
    <option>Mylapore</option>
    <option>Besant Nagar</option>
    <option>Nungambakkam</option>
    <option>Egmore</option>
    <option>Triplicane</option>
  </select>

  <button class="primary" onclick="preBook()">Pre-Book</button>
  <button class="outline" onclick="logout()">Logout</button>

  <!-- üè™ SHOP -->
  <div id="shop" class="shopBox hidden">
    <b>Shop:</b> Local Verified Store

    <button class="success" onclick="callShop()">üìû Call Shop</button>
    <button class="success" onclick="whatsapp()">üí¨ WhatsApp</button>

    <!-- üó∫ MAP -->
    <iframe id="map" width="100%" height="200" loading="lazy"></iframe>

    <!-- üî≥ QR -->
    <div class="qr">
      <b>QR Code (Confirm at Shop)</b><br>
      <img id="qrImg" width="200">
    </div>
  </div>
</div>

</div>

<!-- üî• FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCE21rVu1qcMtjnUhPmNHtef-GfqofnZf0",
  authDomain: "quantum-item-finder-4a990.firebaseapp.com",
  projectId: "quantum-item-finder-4a990",
  storageBucket: "quantum-item-finder-4a990.appspot.com",
  messagingSenderId: "500012758966",
  appId: "1:500012758966:web:a63d60c776f6da1a9ff317"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.login = async () => {
  const e = email.value, p = password.value;
  try {
    await signInWithEmailAndPassword(auth,e,p);
    openApp();
  } catch {
    await createUserWithEmailAndPassword(auth,e,p);
    openApp();
  }
};

window.logout = async ()=>{
  await signOut(auth);
  location.reload();
};

function openApp(){
  loginBox.classList.add("hidden");
  searchBox.classList.remove("hidden");
}

window.preBook = ()=>{
  shop.classList.remove("hidden");

  const a = area.value;
  map.src = `https://www.google.com/maps?q=${a},Chennai&output=embed`;

  const data = `Item:${item.value}, Area:${a}`;
  qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(data)}`;
};

window.callShop = ()=>location.href="tel:+919876543210";
window.whatsapp = ()=>{
  const msg = `Pre-Booking: ${item.value} at ${area.value}`;
  location.href = `https://wa.me/919876543210?text=${encodeURIComponent(msg)}`;
};
</script>

</body>
</html>
