<!DOCTYPE html>
<html>
<head>
  <title>Shop Finder</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{
      margin:0;
      font-family:Arial;
      background:linear-gradient(135deg,#0f172a,#1e293b);
      color:white;
    }
    .box{
      width:320px;
      background:#fff;
      color:#000;
      padding:20px;
      border-radius:12px;
      margin:100px auto;
      display:none;
    }
    input,button{
      width:100%;
      padding:10px;
      margin-top:10px;
      border-radius:6px;
      border:1px solid #ccc;
    }
    button{
      background:#2563eb;
      color:white;
      border:none;
      cursor:pointer;
    }
    .shop{
      background:#111827;
      margin:10px;
      padding:10px;
      border-radius:8px;
    }
  </style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
  <h3>ğŸ” Login</h3>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login / Signup</button>
  <p id="msg"></p>
</div>

<!-- SHOPS -->
<div class="box" id="shopBox">
  <h3>ğŸª Chennai Grocery Shops</h3>
  <div id="shops"></div>
  <button onclick="logout()">Logout</button>
</div>

<script>
/* ğŸ”¥ FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

/* LOGIN */
function login(){
  const e = email.value;
  const p = password.value;

  auth.signInWithEmailAndPassword(e,p)
  .catch(()=>auth.createUserWithEmailAndPassword(e,p))
  .then(()=>{
    loginBox.style.display="none";
    shopBox.style.display="block";
    loadShops();
  })
  .catch(err=>msg.innerText=err.message);
}

/* LOAD SHOPS */
function loadShops(){
  db.collection("shops")
    .where("city","==","Chennai")
    .get()
    .then(res=>{
      shops.innerHTML="";
      res.forEach(doc=>{
        const d = doc.data();
        shops.innerHTML += `
          <div class="shop">
            <b>${d.name}</b><br>
            ğŸ“ ${d.area}<br>
            ğŸ“ ${d.Phone}<br>
            ğŸ›’ ${d.Items.join(", ")}
          </div>
        `;
      });
    });
}

/* LOGOUT */
function logout(){
  auth.signOut().then(()=>{
    shopBox.style.display="none";
    loginBox.style.display="block";
  });
}

/* AUTO CHECK */
auth.onAuthStateChanged(u=>{
  if(u){
    loginBox.style.display="none";
    shopBox.style.display="block";
    loadShops();
  }else{
    loginBox.style.display="block";
  }
});
</script>

</body>
</html>
