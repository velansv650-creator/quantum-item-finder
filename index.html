<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ğŸ‘‘ Quantum Item Finder</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  width:95%;
  max-width:430px;
  background:#fff;
  border-radius:18px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,.3);
}
h2{text-align:center;margin:5px 0 15px}
input,select{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}
button{
  width:100%;
  margin-top:12px;
  padding:12px;
  border:none;
  border-radius:12px;
  font-size:15px;
  font-weight:bold;
  cursor:pointer;
}
.primary{background:linear-gradient(90deg,#1e3c72,#2a5298);color:#fff}
.logout{background:#b02a37;color:#fff}
.shop{
  background:#f5f5f5;
  margin-top:12px;
  padding:14px;
  border-radius:14px;
}
.shop h3{margin:0;color:#1e3c72}
.actions{display:flex;gap:8px;margin-top:8px}
.call{background:#28a745;color:#fff;flex:1}
.map{background:#dc3545;color:#fff;flex:1}
.small{text-align:center;color:#777;margin-top:10px}
.hide{display:none}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h2>ğŸ” Login / Signup</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button class="primary" onclick="login()">Login / Signup</button>
  <div class="small" id="loginMsg"></div>
</div>

<!-- APP -->
<div class="card hide" id="appBox">
  <h2>ğŸ‘‘ Quantum Item Finder</h2>
  <div class="small" id="userEmail"></div>

  <input id="itemInput" placeholder="Search item (rice, sugar, oil)">
  <button class="primary" onclick="searchItem()">ğŸ” Search</button>

  <div id="results"></div>

  <button class="logout" onclick="logout()">Logout</button>
</div>

<script>
/* ğŸ”¥ FIREBASE CONFIG (REPLACE YOUR VALUES) */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

/* AUTH */
function login(){
  const e=email.value,p=password.value;
  auth.signInWithEmailAndPassword(e,p)
  .catch(()=>auth.createUserWithEmailAndPassword(e,p))
  .then(()=>loginMsg.innerText="Login successful");
}
function logout(){auth.signOut();}

auth.onAuthStateChanged(u=>{
  if(u){
    loginBox.classList.add("hide");
    appBox.classList.remove("hide");
    userEmail.innerText="User: "+u.email;
  }else{
    loginBox.classList.remove("hide");
    appBox.classList.add("hide");
  }
});

/* SEARCH */
async function searchItem(){
  const item=itemInput.value.toLowerCase().trim();
  results.innerHTML="";
  if(!item){results.innerHTML="<p class='small'>Enter item</p>";return;}

  const snap=await db.collection("shops").get();
  let found=false;

  snap.forEach(doc=>{
    const d=doc.data();
    if(d.items.map(i=>i.toLowerCase()).includes(item)){
      found=true;
      results.innerHTML+=`
        <div class="shop">
          <h3>ğŸª ${d.name}</h3>
          <p>ğŸ“ ${d.area}, ${d.city}</p>
          <p>ğŸ›’ ${d.items.join(", ")}</p>
          <div class="actions">
            <button class="call" onclick="location.href='tel:${d.phone}'">ğŸ“ Call</button>
            <button class="map" onclick="window.open('https://maps.google.com/?q=${d.lat},${d.lng}')">ğŸ—º Map</button>
          </div>
        </div>`;
    }
  });
  if(!found)results.innerHTML="<p class='small'>No shop found</p>";
}
</script>
</body>
</html>
