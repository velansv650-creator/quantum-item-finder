<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Quantum Item Finder</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
/* ===== BASE ===== */
body{
  margin:0;font-family:"Segoe UI",system-ui;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  min-height:100vh;display:flex;justify-content:center;align-items:center;
  transition:.3s;
}
.card{
  background:#fff;width:95%;max-width:430px;border-radius:18px;
  padding:20px;box-shadow:0 15px 40px rgba(0,0,0,.3);
}
h2{text-align:center;margin:6px 0}
input,select,button{
  width:100%;padding:12px;margin-top:10px;border-radius:12px;
  border:1px solid #ccc;font-size:15px;
}
button{border:none;cursor:pointer}
.primary{background:#3f6ae1;color:#fff}
.green{background:#2e7d32;color:#fff}
.gray{background:#eee}
.shop{background:#f7f7f7;padding:14px;border-radius:14px;margin-top:15px}
.center{text-align:center}
.hide{display:none}
.small{font-size:13px;color:#555;text-align:center}

/* ===== DARK MODE ===== */
body.dark{
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
}
body.dark .card{background:#121212;color:#f1f1f1}
body.dark input,body.dark select{
  background:#1e1e1e;color:#fff;border:1px solid #444
}
body.dark .shop{background:#1c1c1c}
body.dark .gray{background:#333;color:#fff}
body.dark .primary{background:#6c8cff}
body.dark .green{background:#3aa76d}
</style>
</head>

<body>
<div class="card">

<!-- LOGIN -->
<div id="login">
  <h2>üîê Login / Signup</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button class="primary" id="loginBtn">Continue</button>
  <p class="small">Demo login ‚Äì any email/password</p>
</div>

<!-- APP -->
<div id="app" class="hide">
  <h2>üîç Item Search</h2>

  <button class="gray" onclick="toggleTheme()">üåô Dark Mode</button>

  <select id="category">
    <option value="">Select Category</option>
    <option>Grocery</option><option>Vegetables</option><option>Fruits</option>
    <option>Medical</option><option>Stationery</option><option>Electronics</option>
    <option>Bakery</option><option>Dairy</option><option>Hardware</option>
  </select>

  <input id="item" placeholder="Item name (Rice / Pen / Tablet)">

  <select id="itemList">
    <option value="">Select Item from List</option>
  </select>

  <select id="area">
    <option value="">Select Area</option>
    <option>Velachery</option><option>Adyar</option><option>T Nagar</option>
    <option>Guindy</option><option>Anna Nagar</option><option>Tambaram</option>
    <option>Chromepet</option><option>Pallavaram</option><option>Medavakkam</option>
    <option>Sholinganallur</option><option>OMR</option><option>ECR</option>
    <option>Porur</option><option>Ambattur</option><option>Avadi</option>
    <option>Vandalur</option><option>Guduvanchery</option><option>Urapakkam</option>
    <option>Kelambakkam</option><option>Chengalpattu</option>
  </select>

  <button class="primary" onclick="nearMe()">üìç Near Me</button>
  <button class="primary" onclick="search()">Search</button>
  <button class="gray" onclick="logout()">Logout</button>

  <div id="result"></div>
</div>
</div>

<script>
/* ===== DATA ===== */
const itemsByCategory={
  Grocery:["Rice","Wheat","Sugar","Oil","Dal","Salt","Biscuits"],
  Vegetables:["Tomato","Onion","Potato","Carrot","Beans"],
  Fruits:["Apple","Banana","Orange","Mango"],
  Medical:["Paracetamol","Crocin","Vicks","ORS"],
  Stationery:["Pen","Pencil","Notebook","Bag"],
  Electronics:["Mobile","Charger","Earphones"],
  Bakery:["Bread","Cake","Buns"],
  Dairy:["Milk","Curd","Butter","Cheese"],
  Hardware:["Hammer","Screwdriver","Nails","Drill"]
};

/* ===== LOGIN ===== */
document.addEventListener("DOMContentLoaded",()=>{
  if(localStorage.getItem("user")){
    login.style.display="none"; app.classList.remove("hide");
  }
  loginBtn.onclick=()=>{
    if(!email.value||!password.value){alert("Enter email & password");return;}
    localStorage.setItem("user",email.value);
    login.style.display="none"; app.classList.remove("hide");
  };

  // load theme
  if(localStorage.getItem("theme")==="dark"){
    document.body.classList.add("dark");
  }
});
function logout(){localStorage.clear();location.reload();}

/* ===== CATEGORY ‚Üí ITEM LIST ===== */
category.onchange=()=>{
  itemList.innerHTML='<option value="">Select Item from List</option>';
  (itemsByCategory[category.value]||[]).forEach(i=>{
    itemList.innerHTML+=`<option>${i}</option>`;
  });
};
itemList.onchange=()=>{ item.value=itemList.value; };

/* ===== DARK MODE ===== */
function toggleTheme(){
  document.body.classList.toggle("dark");
  localStorage.setItem("theme",
    document.body.classList.contains("dark")?"dark":"light"
  );
}

/* ===== NEAR ME ===== */
function nearMe(){
  area.value="Velachery";
  alert("üìç Location detected: Velachery");
}

/* ===== SEARCH + PAYMENT ===== */
let booking={};
function search(){
  if(!category.value||!item.value||!area.value){
    alert("Select category, item & area"); return;
  }
  booking={
    id:"BOOK"+Math.floor(Math.random()*100000),
    category:category.value,item:item.value,area:area.value,
    paymentMethod:"",paymentStatus:""
  };

  result.innerHTML=`
  <div class="shop">
    <b>Shop:</b> Local Verified Store<br>
    <b>Category:</b> ${booking.category}<br>
    <b>Item:</b> ${booking.item}<br>
    <b>Area:</b> ${booking.area}<br>
    <b>Trust:</b> ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ<br><br>

    <b>Select Payment</b>
    <select id="payMethod">
      <option value="">Choose</option>
      <option value="COD">Cash on Delivery</option>
      <option value="ONLINE">Online Payment (UPI / Card)</option>
    </select>

    <button class="primary" onclick="confirmPayment()">Confirm Payment</button>

    <div id="payInfo" class="small"></div>
    <div id="actions" class="hide">
      <button class="green" onclick="callShop()">üìû Call</button>
      <button class="green" onclick="wa()">üí¨ WhatsApp</button>
      <button class="green" onclick="map()">üìç Map</button>
      <div id="qr" class="center"></div>
    </div>
  </div>`;
}

function confirmPayment(){
  const pm=document.getElementById("payMethod").value;
  if(!pm){alert("Select payment method");return;}
  if(pm==="COD"){
    booking.paymentMethod="Cash on Delivery";
    booking.paymentStatus="Pending";
    payInfo.innerText="Payment: Cash on Delivery (Pay at door)";
  }else{
    booking.paymentMethod="Online";
    booking.paymentStatus="Paid";
    booking.txn="TXN"+Math.floor(Math.random()*1000000);
    payInfo.innerText=`Payment: Online ‚úì (Txn ${booking.txn})`;
  }
  actions.classList.remove("hide");
  qr.innerHTML="";
  new QRCode(qr,{text:JSON.stringify(booking),width:160,height:160});
  alert("Booking Confirmed: "+booking.id);
}

/* ===== ACTIONS ===== */
function callShop(){location.href="tel:+919876543210";}
function wa(){
  const msg=`Booking ${booking.id}
Item: ${booking.item}
Area: ${booking.area}
Payment: ${booking.paymentMethod}`;
  window.open(`https://wa.me/919876543210?text=${encodeURIComponent(msg)}`);
}
function map(){
  window.open(`https://www.google.com/maps/search/${booking.area}+shop`);
}
</script>
</body>
</html>
