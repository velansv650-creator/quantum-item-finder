<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quantum Item Finder</title>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } 
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCE21rVu1qcMtjnUhPmNHtef-GfqofnZf0",
  authDomain: "quantum-item-finder-4a990.firebaseapp.com",
  projectId: "quantum-item-finder-4a990",
  appId: "1:500012758966:web:a63d60c776f6da1a9ff317"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.loginSignup = async () => {
  const email = emailInput.value;
  const password = passwordInput.value;
  try {
    await createUserWithEmailAndPassword(auth, email, password);
    alert("Signup successful ‚úÖ");
    showSearch();
  } catch (e) {
    if (e.code === "auth/email-already-in-use") {
      await signInWithEmailAndPassword(auth, email, password);
      alert("Login successful ‚úÖ");
      showSearch();
    } else {
      alert(e.message);
    }
  }
};

window.logoutUser = async () => {
  await signOut(auth);
  location.reload();
};
</script>

<!-- QR Code -->
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<style>
body {
  background: linear-gradient(135deg,#1f4037,#99f2c8);
  font-family: Arial;
}
.card {
  background:#fff;
  padding:20px;
  width:320px;
  margin:80px auto;
  border-radius:10px;
}
input,select,button {
  width:100%;
  padding:10px;
  margin-top:10px;
}
button {
  border:none;
  color:white;
  font-size:16px;
  cursor:pointer;
}
.blue { background:#3f51b5; }
.red { background:#d84315; }
.green { background:#2e7d32; }
.hidden { display:none; }
</style>
</head>

<body>

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h2>üîê Login / Signup</h2>
  <input id="emailInput" placeholder="Email">
  <input id="passwordInput" type="password" placeholder="Password">
  <button class="blue" onclick="loginSignup()">Login / Signup</button>
</div>

<!-- SEARCH -->
<div class="card hidden" id="searchBox">
  <h2>üîç Item Search</h2>

  <select id="category">
    <option>Groceries</option>
    <option>Electronics</option>
    <option>Stationery</option>
  </select>

  <input id="itemName" placeholder="Item name">

  <select id="area">
    <option>Chennai - T Nagar</option>
    <option>Chennai - Velachery</option>
    <option>Chennai - Tambaram</option>
  </select>

  <button class="blue" onclick="preBook()">Pre-Book</button>
  <button class="red" onclick="logoutUser()">Logout</button>

  <div id="result" class="hidden">
    <hr>
    <p><b>Shop:</b> Local Store</p>

    <button class="green" onclick="callShop()">üìû Call</button>
    <button class="green" onclick="whatsappShop()">üí¨ WhatsApp</button>

    <h3>QR Code (Confirm at Shop)</h3>
    <div id="qrcode"></div>
  </div>
</div>

<script>
function showSearch() {
  loginBox.classList.add("hidden");
  searchBox.classList.remove("hidden");
}

function preBook() {
  result.classList.remove("hidden");
  qrcode.innerHTML = "";
  new QRCode(qrcode, {
    text: itemName.value + " | " + area.value,
    width:150,
    height:150
  });
  alert("Pre-Booking Confirmed ‚úÖ");
}

function callShop() {
  window.location.href = "tel:9876543210";
}

function whatsappShop() {
  const msg = `Pre-Booking Item: ${itemName.value} Area: ${area.value}`;
  window.open(`https://wa.me/919876543210?text=${encodeURIComponent(msg)}`);
}
</script>

</body>
</html>
